<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.kbms_module.dao.DocTagMapper" >
  <!--映射Doc文档查询的基本类-->
  <resultMap id="DocResultMap" type="com.kbms_module.pojo.Doc">
  <!--
    WARNING - @mbggenerated
    This element is automatically generated by MyBatis Generator, do not modify.
  -->
  <result column="id" jdbcType="INTEGER" property="id" />
  <result column="title" jdbcType="VARCHAR" property="title" />
  <result column="author_id" jdbcType="INTEGER" property="authorId" />
  <result column="type_id" jdbcType="INTEGER" property="typeId" />
  <result column="createTime" jdbcType="TIMESTAMP" property="createtime" />
  <result column="favers" jdbcType="INTEGER" property="favers" />
  <result column="dislikes" jdbcType="INTEGER" property="dislikes" />
  <result column="comments" jdbcType="INTEGER" property="comments" />
  <result column="collections" jdbcType="INTEGER" property="collections" />
  <result column="visitnums" jdbcType="INTEGER" property="visitnums" />
  <result column="hostnums" jdbcType="DOUBLE" property="hostnums" />
  <result column="groupid" jdbcType="INTEGER" property="groupid" />
  <result column="edittime" jdbcType="TIMESTAMP" property="edittime" />
  <result column="privcaty" jdbcType="INTEGER" property="privcaty" />
  <result column="summary" jdbcType="VARCHAR" property="summary" />
  <result column="tags" jdbcType="VARCHAR" property="tags" />
  <result property="StypeId" column="s_id" jdbcType="INTEGER"></result>
  <result property="BtypeId" column="b_id" jdbcType="INTEGER"></result>
  <result column="previewurl" jdbcType="VARCHAR" property="previewurl" />
  </resultMap>
  <!--标签基本类-->
  <resultMap id="TagsResultMap" type="com.kbms_module.pojo.Tags">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <result column="id" jdbcType="INTEGER" property="id" />
    <result column="name" jdbcType="VARCHAR" property="name" />
    <result column="tag_hots" jdbcType="INTEGER" property="tagHots" />
    <result column="posts" jdbcType="INTEGER" property="posts" />
  </resultMap>
  <!--封装的类型-->
  <resultMap id="DocResultWithTags" type="com.kbms_module.pojo.Doc" extends="DocResultMap">
    <!--阔藏出级联查询-->
    <collection property="tagsList" resultMap="TagsResultMap">
    </collection>
  </resultMap>


  <insert id="insertDocTag">
    insert into doc_tag (docid,tagid) values (#{did},#{tid})
  </insert>
  <select id="getDocByidWithTags"  resultMap="DocResultWithTags" parameterType="Integer">
    select a.*,b.*
    from doc a,tags b,doc_tag c
    where a.id=#{did}
    and
    c.docid=a.id
    and
    c.tagid=b.id
  </select>
</mapper>