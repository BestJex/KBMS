<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.kbms_module.dao.GroupMapper" >
  <resultMap id="BaseResultMap" type="com.kbms_module.pojo.Group" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->

    <result column="id" property="id" jdbcType="INTEGER" />
    <result column="create_id" property="createId" jdbcType="INTEGER" />
    <result column="group_name" property="groupName" jdbcType="VARCHAR" />
    <result column="group_nums" property="groupNums" jdbcType="INTEGER" />
    <result column="group_headimg" property="groupHeadimg" jdbcType="VARCHAR" />
    <result column="group_docnum" property="groupDocnum" jdbcType="INTEGER" />
    <result column="group_status" property="groupStatus" jdbcType="VARCHAR" />
    <result column="group_descirate" property="groupDescirate" jdbcType="VARCHAR" />
    <result column="group_time" jdbcType="TIMESTAMP" property="groupTime" />
    <!--所有的小组成员-->
    <collection property="user" resultMap="com.kbms_module.dao.UserMapper.BaseResultMap">
    </collection>
  </resultMap>
  <insert id="insert" parameterType="com.generator.pojo.Group" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into group (id, create_id, group_name, 
      group_nums, group_headimg, group_docnum, 
      group_status, group_descirate)
    values (#{id,jdbcType=INTEGER}, #{createId,jdbcType=INTEGER}, #{groupName,jdbcType=VARCHAR}, 
      #{groupNums,jdbcType=INTEGER}, #{groupHeadimg,jdbcType=VARCHAR}, #{groupDocnum,jdbcType=INTEGER}, 
      #{groupStatus,jdbcType=VARCHAR}, #{groupDescirate,jdbcType=VARCHAR})
  </insert>
  <insert id="insertSelective" parameterType="com.generator.pojo.Group" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into group
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        id,
      </if>
      <if test="createId != null" >
        create_id,
      </if>
      <if test="groupName != null" >
        group_name,
      </if>
      <if test="groupNums != null" >
        group_nums,
      </if>
      <if test="groupHeadimg != null" >
        group_headimg,
      </if>
      <if test="groupDocnum != null" >
        group_docnum,
      </if>
      <if test="groupStatus != null" >
        group_status,
      </if>
      <if test="groupDescirate != null" >
        group_descirate,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        #{id,jdbcType=INTEGER},
      </if>
      <if test="createId != null" >
        #{createId,jdbcType=INTEGER},
      </if>
      <if test="groupName != null" >
        #{groupName,jdbcType=VARCHAR},
      </if>
      <if test="groupNums != null" >
        #{groupNums,jdbcType=INTEGER},
      </if>
      <if test="groupHeadimg != null" >
        #{groupHeadimg,jdbcType=VARCHAR},
      </if>
      <if test="groupDocnum != null" >
        #{groupDocnum,jdbcType=INTEGER},
      </if>
      <if test="groupStatus != null" >
        #{groupStatus,jdbcType=VARCHAR},
      </if>
      <if test="groupDescirate != null" >
        #{groupDescirate,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
    <insert id="createGroup" useGeneratedKeys="true" keyProperty="id" >
      insert into k_group (create_id,group_name,group_nums,group_headimg,group_descirate,group_time) values (#{createId},#{groupName},#{groupNums},#{groupHeadimg},#{groupDescirate},#{groupTime})
    </insert>
  <insert id="createUserGroup">
    insert into user_group (uid,gid) VALUES (#{userId},#{id})
  </insert>
  <select id="getlastestgroup" resultType="com.kbms_module.pojo.Group" parameterType="Integer">
    select * from k_group order by group_time desc limit #{i}
  </select>
    <select id="getAllGroup"  resultMap="BaseResultMap">
      select * from k_group
    </select>
  <select id="getUserForGroup" resultMap="BaseResultMap">
    select * from  k_group a,user b,user_group c
    where a.id=#{gid}
    and
    c.gid=a.id
    and
    c.uid=b.user_id
  </select>
  <select id="getDocsbyGid" resultMap="com.kbms_module.dao.DocDao.BaseResultMap">
    select * from  doc where groupid=#{gid}
  </select>
</mapper>